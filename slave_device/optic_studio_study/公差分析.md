# 公差分析
## 公差分析简介
* 在一个光学设计方案进行公差分析之前，您无法确认它是可以被加工的。
* 评价函数值最小的设计不一定是最佳的选择
* 您必须选择结合系统的“可制造型”和低评价数值进行权衡
## 公差分析的含义
* 公差分析可用来分析生产制造误差和校准误差会对光学系统成像质量产生什么样的影响
* 分析目的要比过程简单
    * 在光学中所有变量会对其他表面参数产生非线性的影响
* 公差分析用来分析实际情况
    * 没有一个光学表面的抛光是完美的
    * 没有一个机械零件的加工时完美的
* 关键问题在于:
    * 它有多接近完美？
* 公差分析的目的：在保证系统的成像质量符合要求的情况下，确定所允许引入加工误差的量
* 将光学设计付诸生产时，所得到产品的成像质量仍可以保证与设计结果相符
* 通常情况下，公差不合理的光学设计将导致实际产品的成像质量无法符合设计要求（光斑尺寸、波前差、MTF等）
    * 成像质量下降
* 任何光学原件都无法被100%正确的加工与装配：
    * 分配光学元件的加工公差、机械零件的公差、光机装配的公差
    * 分析影响像质的敏感因素斌在制造过程中加强控制
    * 在满足系统性能要求的情况下，放松对不敏感参数的限制
    * 尽可能降低加工制造难度
    * 尽可能减少元件成本、装配成本和测试成本
    * 预测系统最终性能及像质
## 误差来源
* 公差分析内可以考虑很多误差类型
    * 加工
    * 材料
    * 装配
    * 环境
    * 设计误差 
### 加工误差 
* 误差来源
    * 曲率半径的误差
    * 元件过薄或过厚
    * 表面面型的不规则度
    * 曲率中心与机械中心偏离
    * 不准确的圆锥系数或非球面系数
### 材料误差
* 材料误差包括
    * 折射率的准确性
    * 折射率的均匀性
    * 折射率分布
    * 阿贝数（色散）
### 装配误差
* 装配误差的来源
    * 元件与机械轴存在x方向或y方向的偏心
    * 元件的z轴（光轴）位置偏离
    * 元件关于z轴间发生倾斜
    * 元件的装配方向错误
    * 整组元件产生如上所述误差
### 环境误差
* 另一个误差源是环境因素，包括装配和使用过程中的温度、湿度和压强等
    * 光学元件和机械零件的热膨胀/收缩
    * 温度对材料折射率的影响
    * 装配校准的精度受振动的影响
    * 机械应力
### 设计冗余误差
* 通常来讲，光学系统的设计结果都会包含一定量的冗余设计误差（评价函数不为0）
* 设计误差通常情况下随着视场的改变而不同
* 对于合理的参数公差范围，系统的冗余设计误差应该只占系统误差的一小部分
### 误差评估
* 误差分配是考虑所有误差对系统成像质量贡献量的一种方法
* 这可以使设计人员预测系统设计在所规定的误差范围内装配后的成像质量
* 为了进行误差分配，设计人员必须：
    * 选择合适的成像质量评价标准
    * 确定可接受的最小成像质量水平
    * 计算所有可能的误差源对成像质量的影响
        * 每个表面、元件、元件组和机械装配体
    * 对所有加工零件和装配体设置相应的误差范围
* 误差分配定义了系统从设计、制造、装配和使用的每一步过程中，所产生的所有误差的最大限度
* 误差分配必须考虑以下几种误差类型
    * 公差分析以外的误差来源
        * 设计误差、环境误差
    * 公差分析内的误差来源
        * 制造误差、材料误差、装配误差
* 额外的余量用于预防特殊的实际情况
### Zemax的公差分析能力
* Zemax可以在公差数据编辑器中为各种参数设置公差
    * 有一个默认的公差生成器，它可以自动输入以下参数的公差：曲率半径、光晕、厚度、位置、X和Y倾斜、X和Y偏心、不规则性、楔形、玻璃折射率、阿贝数等
    * 其他公差类型：非球面常数、偏心/斜率、求解和参数公差等。
* 可以定义您希望使用的补偿器，例如焦点、倾斜和任何光学元件、表面或元件组的位置
    * 一般使用焦点位置
* 可以选择合理的公差评价标准
    * 一般使用RMS波前
* Zemax使用以下三种工具之一或全部进行公差分析
    * 灵敏度分析
    * 逆（反）灵敏度分析
    * 蒙特卡洛分析
#### 灵敏度分析
* 灵敏度分析考虑了每一项公差对于系统性能的独立影响，使重要分析工具
* 在执行灵敏度分析时，将参数调整到公差范围的极限，然后确定每个补偿器的最优值
    * 如系统的名义值曲率半径为R，定义的曲率半径公差大小为$\Delta$ R